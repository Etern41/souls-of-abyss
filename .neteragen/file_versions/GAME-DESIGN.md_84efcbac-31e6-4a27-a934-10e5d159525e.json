{
  "file_name": "GAME-DESIGN.md",
  "revision_id": "84efcbac-31e6-4a27-a934-10e5d159525e",
  "metadata": {
    "timestamp": "2025-12-09T12:28:01.680804",
    "type": "cache_version",
    "source": "initial",
    "size": 11446,
    "is_reverted": false,
    "git_branch_name": "",
    "agent_name": "Cody",
    "description": null
  },
  "content": "# SOULS OF THE ABYSS - GAME DESIGN (QUADCODE IDE VERSION)\n\n## OVERVIEW\n\nDark fantasy Vampire Survivors-like. Player survives waves of enemies, collects souls, levels up weapons, defeats bosses. **With Quadcode IDE: visuals generated by Dali, animations by Sonic, code by Cody/Jace.**\n\n---\n\n## PART 1: CORE MECHANICS\n\n### Game Loop\n- **Wave spawning:** Every 30 seconds, 5 + (waveNumber × 2) enemies spawn in circle 100px around player\n- **Boss spawning:** Every 120 seconds, rotates through 3 bosses (Shadow Lord → Void Rift → Ancient One)\n- **Difficulty scaling:** multiplier = 1 + (gameTime / 4), applies to enemy health/damage\n- **Player leveling:** +1 level per 100 XP, unlock weapon upgrade at level 3\n- **Essence economy:** 5 essence souls = 1 weapon charge\n\n### Player Characters\n\n| Character | HP | DMG | Range | Speed | Special |\n|-----------|-----|------|-------|-------|---------|\n| Knight | 100 | 12 | 110px | 200 | +1 armor/level |\n| Witch | 70 | 8 | 140px | 180 | Better scaling |\n| Rogue | 85 | 10 | 90px | 250 | 10% dodge, kill streak |\n\n### Weapons (9 Total)\n\n| # | Weapon | Damage | Rate | Range | Type | Special |\n|---|--------|--------|------|-------|------|---------|\n| 1 | Cursed Blade | 10 | 1/s | 100px | Cone 100° | Basic |\n| 2 | Shatterburst Axe | 15 | 0.8/s | AOE 50px | Explosion | Knockback |\n| 3 | Soulreaver Dagger | 5×3 | 2/s | 20px | Pierce | 20% lifesteal |\n| 4 | Eternal Halberd | 25 | 0.5/s | AOE 80px | Knockback | +pull 200px |\n| 5 | Chaos Orb | 8×2-4 | 1.2/s | Projectile | Pierce | Multiple orbs |\n| 6 | Reaper's Scythe | 20 | 0.8/s | AOE 100px | Spin | +pull 200px |\n| 7 | Bloodmoon Lance | 20 | 1/s | Beam | Lifesteal | 50% heal |\n| 8 | Godsayer Sword | 100 | 1 charge | 150px | Massive | E key, 1 Essence |\n| 9 | Void Summoner | 5×3 | 8 sec | Tentacles | Summon | 2 Essence cost |\n\n### Enemy Types (10 Total)\n\n**Regular (80%):**\n- Zombie: 20 HP, 5 DMG, 80 speed, gray\n- Spectre: 18 HP, 4 DMG, 90 speed, blue\n- Cultist: 22 HP, 6 DMG, 100 speed, purple\n\n**Elite (15%):**\n- Vampire: 40 HP, 10 DMG, 120 speed, red\n- Wraith: 38 HP, 9 DMG, 110 speed, black (spiral movement)\n- Corrupted Knight: 50 HP, 15 DMG, 60 speed, dark armor\n- Warden: 42 HP, 11 DMG, 100 speed, cyan\n\n**Boss (5%, every 120s):**\n- Shadow Lord: 200 HP, 30 DMG, 80 speed, red glow\n- Void Rift: 250 HP, 35 DMG, 70 speed, black void\n- Ancient One: 300 HP, 40 DMG, 75 speed, cosmic\n\n### Soul System\n\n| Type | XP | Rate | Color |\n|------|-----|------|-------|\n| Ethereal | 10 XP | Regular 95% | white-blue |\n| Essence | 0 XP + 1 charge | Regular 5% | gold |\n| Corrupted | 20 XP | Elite 50% | dark red |\n| Cursed | 50 XP | Boss 40% | black |\n\n---\n\n## PART 2: VISUAL SYSTEM (FOR DALI)\n\n### Character Sprites\n\n**Knight:**\n- Idle: Standing with sword, armor glowing red\n- Run: Legs moving, sword raised, cape flowing\n- Attack: Sword swing animation (3 frames)\n- Death: Collapses, fades out\n\n**Witch:**\n- Idle: Staff ready, robe flowing, aura\n- Run: Levitating movement, robe trailing\n- Cast: Staff glow, projectile appearing\n- Death: Dissipates into particles\n\n**Rogue:**\n- Idle: Crouched, dagger ready, shadows\n- Run: Quick dashing movement, blur trails\n- Attack: Dagger thrust, dodge roll\n- Death: Vanishes, leaves shadow\n\n### Enemy Sprites (3 variants per type shown, simplified)\n\n**Zombie:** Shambling walk, tattered clothing, decaying\n**Spectre:** Floating, ethereal, translucent\n**Cultist:** Walking, robed, glowing staff\n**Vampire:** Elegant walk, cape, red glowing eyes\n**Wraith:** Spiral movement pattern, shadowy\n**Corrupted Knight:** Armored walk, broken armor\n**Warden:** Patrol movement, glowing symbols\n**Shadow Lord (Boss):** Huge shadowy form, aura\n**Void Rift (Boss):** Black swirling void, particles\n**Ancient One (Boss):** Cosmic form, stars, tentacles\n\n### Weapon Effects (Sonic animations)\n\n- **Blade:** Slash arc, trail particles\n- **Axe:** Swing + explosion burst\n- **Dagger:** Quick stabs, blood drops\n- **Halberd:** Wide swing, pull effect (chains)\n- **Orbs:** Projectile flight, bounce\n- **Scythe:** Spiral spin, pull effect\n- **Lance:** Beam shot, lifesteal glow\n- **Godsayer:** Massive sword slam, screen shake\n- **Tentacles:** Growth from ground, whipping\n\n### Particle System (Sonic)\n\n- **Slash:** 5-8 line particles, fade out\n- **Explosion:** 10-15 circles, expanding then fade\n- **Spark:** 3-5 sparks, trajectory + gravity\n- **Blood:** 3-4 drops, red, gravity down\n- **Glow:** Ring expanding, color-based (gold, red, blue)\n- **Lifesteal:** Souls floating to player\n- **Kill streak:** +DMG indicator, yellow glow\n\n### Map Layout (Dali)\n\n- **Terrain:** Gradient purple-blue background with fog effect\n- **Mountains:** Silhouettes left/right\n- **Center Rune:** Glowing ritual circle (spawner location)\n- **8 Pillars:** Dark stone around edges (visual landmarks)\n- **Glow ring:** Around player (safe zone visual)\n- **Particle fog:** Ambient drifting particles\n\n### HUD (HTML5)\n\n- **Top-left:** Time, Level, HP bar, Armor\n- **Top-right:** Wave number, Enemy count\n- **Bottom-left:** Essence charges (5 collected = 1), Current weapon\n- **Bottom-right:** Boss timer (countdown to next boss)\n- **Center (on death):** Modal with stats (survive time, wave, kills, level, best weapon)\n\n---\n\n## PART 3: ANIMATION STATES (FOR SONIC)\n\n### Character Animation Cycles\n\n**Knight:**\n- Idle (2 sec loop): Breathing, sword steady\n- Run (0.5 sec loop): 4-frame leg cycle\n- Attack (0.3 sec): Sword swing, 2-frame\n- Hit (0.2 sec): Knockback reaction\n- Death (1 sec): Fall + fade\n\n**Witch:**\n- Idle (2 sec): Levitation bob, aura pulse\n- Run (0.4 sec): Floating movement, 3-frame\n- Cast (0.4 sec): Staff glow buildup, projectile spawn\n- Hit (0.2 sec): Knockback with sparkles\n- Death (1.5 sec): Dissipate animation\n\n**Rogue:**\n- Idle (1 sec): Crouch ready, shadow\n- Run (0.3 sec): Dashing, 3-frame blur\n- Attack (0.2 sec): Dagger thrust, instant\n- Dodge (0.4 sec): Roll animation, invincibility frame\n- Death (0.8 sec): Vanish with shadow\n\n### Enemy Animation Cycles\n\n**Zombie:**\n- Shamble (1 sec): Slow walk, 2-frame\n- Attack (0.4 sec): Lunge forward\n- Death (0.8 sec): Collapse, fade\n\n**Spectre:**\n- Float (1.5 sec): Hovering bob, 2-frame\n- Attack (0.5 sec): Dash forward\n- Death (1 sec): Dissipate into particles\n\n**Boss Cycles:**\n- Idle (2 sec): Breathing/pulsing, varies per boss\n- Attack (0.6 sec): Boss-specific move\n- Hit (0.3 sec): Flash white\n- Phase change (1 sec): Intensity increase at 50% HP\n- Death (2 sec): Explosion + particle burst\n\n---\n\n## PART 4: IMPLEMENTATION GUIDE\n\n### What Cody/Jace Will Generate\n\n**game.js (~1200 lines):**\n- Vector2 class (distance, angle, normalize)\n- Weapon class (9 weapons with exact stats)\n- Player class (3 characters, movement, leveling)\n- Enemy class (10 types, difficulty scaling)\n- Soul class (4 types, spawn rates)\n- Particle class (animation with lifetime)\n- gameState object (centralized state)\n- gameLoop() — update all entities\n- drawGame(ctx) — render on canvas\n- spawnWave(), spawnBoss(), collision detection\n- **Animation state handling:** currentState, animationTime, frameIndex for sprite selection\n\n**index.html (~600 lines):**\n- Canvas 1000×600\n- Character select buttons\n- HUD updates (real-time)\n- Death screen modal\n- WASD + E input handling\n- Sprite references (to images generated by Dali)\n- Animation frame cycling for each entity\n\n### What Dali Will Generate\n\n**Sprite Sheets (for each type):**\n- `knight.png` — idle, run, attack, hit, death (48×48 each frame)\n- `witch.png` — idle, run, cast, hit, death\n- `rogue.png` — idle, run, attack, dodge, death\n- `zombie.png`, `spectre.png`, `cultist.png` (regular enemies)\n- `vampire.png`, `wraith.png`, `corrupted_knight.png`, `warden.png` (elites)\n- `shadow_lord.png`, `void_rift.png`, `ancient_one.png` (bosses)\n- `particles.png` — slash, explosion, spark, blood, glow\n- `map.png` — background with mountains, pillars, rune\n- `ui.png` — health bar, icons, borders\n\n**Total:** ~12-15 sprite sheets, all optimized PNG, indexed colors for web\n\n### What Sonic Will Generate\n\n**Animation Specifications (for each sprite sheet):**\n- Frame timings (e.g., idle: 0.25s per frame, 8 frames = 2s loop)\n- Loop points (idle loops, attack doesn't)\n- Transition rules (idle → run, run → idle, attack → idle)\n- Physics (gravity for particles, acceleration)\n- Easing curves (ease-in for attacks, ease-out for deaths)\n- Sonic will provide JSON files with animation metadata\n\n### How It All Connects\n\n1. **Dali generates sprites** → Saved as PNG files in project\n2. **Sonic generates animation specs** → JSON files describe frame timing\n3. **game.js loads both** → Creates Sprite objects with frame data\n4. **Animation loop** → Uses currentState + animationTime to pick frame index\n5. **drawGame()** → Calls ctx.drawImage with correct sprite frame\n\n---\n\n## PART 5: TECHNICAL SPECS\n\n### Canvas API Usage\n- `ctx.drawImage(sprite, srcX, srcY, srcW, srcH, destX, destY, destW, destH)`\n- `ctx.fillRect()`, `ctx.arc()` for shapes (fallback if sprite missing)\n- `ctx.fillText()` for HUD\n\n### Performance Target\n- 60 FPS with 50+ enemies\n- Sprite sheets cached in memory\n- Particle limit: 500 active particles max\n- Collision: Distance-based, O(n²) acceptable for enemy count\n\n### File Structure\n```\nsouls-of-abyss/\n├── index.html          ← From Cody (HTML + Canvas setup)\n├── game.js             ← From Cody (Logic + Animation system)\n├── sprites/\n│   ├── knight.png      ← From Dali\n│   ├── witch.png\n│   ├── rogue.png\n│   ├── zombie.png\n│   ├── ... (9 more enemies)\n│   ├── particles.png\n│   └── map.png\n├── animations/\n│   ├── knight.json     ← From Sonic\n│   ├── zombie.json\n│   └── ... (metadata)\n├── README.md\n└── GAME-DESIGN.md\n```\n\n### Success Criteria\n- ✅ All 9 weapons work with correct mechanics\n- ✅ All 10 enemy types spawn with difficulty scaling\n- ✅ Characters animate smoothly (no jank)\n- ✅ Sprites load and display correctly\n- ✅ 60 FPS maintained with 50+ entities\n- ✅ Bosses spawn every 120s with new sprites\n- ✅ Particles spawn on damage, pickup, death\n- ✅ HUD updates in real-time\n- ✅ Death screen shows stats\n- ✅ No console errors\n\n---\n\n## PART 6: AGENTS & WORKFLOW\n\n### Agent Assignments\n\n| Agent | Task | Files |\n|-------|------|-------|\n| **Cody** (Developer) | game.js + index.html | Code generation |\n| **Dali** (Designer) | Sprite sheets | 12 PNG files |\n| **Sonic** (Motion) | Animation specs | JSON metadata |\n| **Jace** (QA) | Bug fixing & optimization | Code review |\n\n### Generation Workflow\n\n```\n1. Cody generates game.js\n   - Loads sprite references (fallback: shapes)\n   - Sprite object with frame timing\n   - drawGame() uses ctx.drawImage()\n\n2. Dali generates sprites\n   - Knight, Witch, Rogue (characters)\n   - 7 enemy types (regular + elite)\n   - 3 bosses\n   - Particles, UI, map\n   \n3. Sonic generates animation JSON\n   - Frame counts per animation state\n   - Timing for each frame\n   - Loop/non-loop flags\n   \n4. Cody updates game.js to load JSON\n   - Links sprite sheets to animation specs\n   - Updates animation state machine\n   \n5. Jace tests everything\n   - Runs game in browser\n   - Checks sprite alignment\n   - Verifies 60 FPS\n   - Fixes bugs\n```\n\n---\n\n## PART 7: PROMPTS FOR EACH AGENT\n\n### For Cody (game.js + index.html)\nSee PROMPTS.md → PROMPT #1 & #2 (with animation system added)\n\n### For Dali (Sprite Generation)\nSee PROMPTS.md → PROMPT #3\n\n### For Sonic (Animation Specs)\nSee PROMPTS.md → PROMPT #4\n\n---\n\nThis design **fully leverages Quadcode IDE agents** while maintaining scope and quality.\n",
  "saved_at": "2025-12-09T12:28:01.680804"
}