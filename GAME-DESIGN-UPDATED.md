# SOULS OF THE ABYSS - UPDATED GAME DESIGN (QUADCODE IDE VERSION)

## OVERVIEW

Dark fantasy Vampire Survivors-like. Player survives waves of enemies, collects souls, levels up weapons, defeats bosses. **With Quadcode IDE: visuals generated by Dali, animations by Sonic, code by Cody/Jace.**

---

## PART 1: CORE MECHANICS

### Game Loop
- **Wave spawning:** Every 30 seconds, 5 + (waveNumber × 2) enemies spawn in circle 100px around player
- **Boss spawning:** Every 120 seconds, rotates through 3 bosses (Shadow Lord → Void Rift → Ancient One)
- **Difficulty scaling:** multiplier = 1 + (gameTime / 4), applies to enemy health/damage
- **Player leveling:** +1 level per 100 XP, unlock weapon upgrade at level 3
- **Essence economy:** 5 essence souls = 1 weapon charge

### Player Characters

| Character | HP | DMG | Range | Speed | Special |
|-----------|-----|------|-------|-------|---------|
| Knight | 100 | 12 | 110px | 200 | +1 armor/level |
| Witch | 70 | 8 | 140px | 180 | Better scaling |
| Rogue | 85 | 10 | 90px | 250 | 10% dodge, kill streak |

### Weapons (9 Total)

| # | Weapon | Damage | Rate | Range | Type | Special |
|---|--------|--------|------|-------|------|---------|
| 1 | Cursed Blade | 10 | 1/s | 100px | Cone 100° | Basic |
| 2 | Shatterburst Axe | 15 | 0.8/s | AOE 50px | Explosion | Knockback |
| 3 | Soulreaver Dagger | 5×3 | 2/s | 20px | Pierce | 20% lifesteal |
| 4 | Eternal Halberd | 25 | 0.5/s | AOE 80px | Knockback | +pull 200px |
| 5 | Chaos Orb | 8×2-4 | 1.2/s | Projectile | Pierce | Multiple orbs |
| 6 | Reaper's Scythe | 20 | 0.8/s | AOE 100px | Spin | +pull 200px |
| 7 | Bloodmoon Lance | 20 | 1/s | Beam | Lifesteal | 50% heal |
| 8 | Godsayer Sword | 100 | 1 charge | 150px | Massive | E key, 1 Essence |
| 9 | Void Summoner | 5×3 | 8 sec | Tentacles | Summon | 2 Essence cost |

### Enemy Types (10 Total)

**Regular (80%):**
- Zombie: 20 HP, 5 DMG, 80 speed, gray
- Spectre: 18 HP, 4 DMG, 90 speed, blue
- Cultist: 22 HP, 6 DMG, 100 speed, purple

**Elite (15%):**
- Vampire: 40 HP, 10 DMG, 120 speed, red
- Wraith: 38 HP, 9 DMG, 110 speed, black (spiral movement)
- Corrupted Knight: 50 HP, 15 DMG, 60 speed, dark armor
- Warden: 42 HP, 11 DMG, 100 speed, cyan

**Boss (5%, every 120s):**
- Shadow Lord: 200 HP, 30 DMG, 80 speed, red glow
- Void Rift: 250 HP, 35 DMG, 70 speed, black void
- Ancient One: 300 HP, 40 DMG, 75 speed, cosmic

### Soul System

| Type | XP | Rate | Color |
|------|-----|------|-------|
| Ethereal | 10 XP | Regular 95% | white-blue |
| Essence | 0 XP + 1 charge | Regular 5% | gold |
| Corrupted | 20 XP | Elite 50% | dark red |
| Cursed | 50 XP | Boss 40% | black |

---

## PART 2: VISUAL SYSTEM (FOR DALI)

### Character Sprites

**Knight:**
- Idle: Standing with sword, armor glowing red
- Run: Legs moving, sword raised, cape flowing
- Attack: Sword swing animation (3 frames)
- Death: Collapses, fades out

**Witch:**
- Idle: Staff ready, robe flowing, aura
- Run: Levitating movement, robe trailing
- Cast: Staff glow, projectile appearing
- Death: Dissipates into particles

**Rogue:**
- Idle: Crouched, dagger ready, shadows
- Run: Quick dashing movement, blur trails
- Attack: Dagger thrust, dodge roll
- Death: Vanishes, leaves shadow

### Enemy Sprites (3 variants per type shown, simplified)

**Zombie:** Shambling walk, tattered clothing, decaying
**Spectre:** Floating, ethereal, translucent
**Cultist:** Walking, robed, glowing staff
**Vampire:** Elegant walk, cape, red glowing eyes
**Wraith:** Spiral movement pattern, shadowy
**Corrupted Knight:** Armored walk, broken armor
**Warden:** Patrol movement, glowing symbols
**Shadow Lord (Boss):** Huge shadowy form, aura
**Void Rift (Boss):** Black swirling void, particles
**Ancient One (Boss):** Cosmic form, stars, tentacles

### Weapon Effects (Sonic animations)

- **Blade:** Slash arc, trail particles
- **Axe:** Swing + explosion burst
- **Dagger:** Quick stabs, blood drops
- **Halberd:** Wide swing, pull effect (chains)
- **Orbs:** Projectile flight, bounce
- **Scythe:** Spiral spin, pull effect
- **Lance:** Beam shot, lifesteal glow
- **Godsayer:** Massive sword slam, screen shake
- **Tentacles:** Growth from ground, whipping

### Particle System (Sonic)

- **Slash:** 5-8 line particles, fade out
- **Explosion:** 10-15 circles, expanding then fade
- **Spark:** 3-5 sparks, trajectory + gravity
- **Blood:** 3-4 drops, red, gravity down
- **Glow:** Ring expanding, color-based (gold, red, blue)
- **Lifesteal:** Souls floating to player
- **Kill streak:** +DMG indicator, yellow glow

### Map Layout (Dali)

- **Terrain:** Gradient purple-blue background with fog effect
- **Mountains:** Silhouettes left/right
- **Center Rune:** Glowing ritual circle (spawner location)
- **8 Pillars:** Dark stone around edges (visual landmarks)
- **Glow ring:** Around player (safe zone visual)
- **Particle fog:** Ambient drifting particles

### HUD (HTML5)

- **Top-left:** Time, Level, HP bar, Armor
- **Top-right:** Wave number, Enemy count
- **Bottom-left:** Essence charges (5 collected = 1), Current weapon
- **Bottom-right:** Boss timer (countdown to next boss)
- **Center (on death):** Modal with stats (survive time, wave, kills, level, best weapon)

---

## PART 3: ANIMATION STATES (FOR SONIC)

### Character Animation Cycles

**Knight:**
- Idle (2 sec loop): Breathing, sword steady
- Run (0.5 sec loop): 4-frame leg cycle
- Attack (0.3 sec): Sword swing, 2-frame
- Hit (0.2 sec): Knockback reaction
- Death (1 sec): Fall + fade

**Witch:**
- Idle (2 sec): Levitation bob, aura pulse
- Run (0.4 sec): Floating movement, 3-frame
- Cast (0.4 sec): Staff glow buildup, projectile spawn
- Hit (0.2 sec): Knockback with sparkles
- Death (1.5 sec): Dissipate animation

**Rogue:**
- Idle (1 sec): Crouch ready, shadow
- Run (0.3 sec): Dashing, 3-frame blur
- Attack (0.2 sec): Dagger thrust, instant
- Dodge (0.4 sec): Roll animation, invincibility frame
- Death (0.8 sec): Vanish with shadow

### Enemy Animation Cycles

**Zombie:**
- Shamble (1 sec): Slow walk, 2-frame
- Attack (0.4 sec): Lunge forward
- Death (0.8 sec): Collapse, fade

**Spectre:**
- Float (1.5 sec): Hovering bob, 2-frame
- Attack (0.5 sec): Dash forward
- Death (1 sec): Dissipate into particles

**Boss Cycles:**
- Idle (2 sec): Breathing/pulsing, varies per boss
- Attack (0.6 sec): Boss-specific move
- Hit (0.3 sec): Flash white
- Phase change (1 sec): Intensity increase at 50% HP
- Death (2 sec): Explosion + particle burst

---

## PART 4: IMPLEMENTATION GUIDE

### What Cody/Jace Will Generate

**game.js (~1200 lines):**
- Vector2 class (distance, angle, normalize)
- Weapon class (9 weapons with exact stats)
- Player class (3 characters, movement, leveling)
- Enemy class (10 types, difficulty scaling)
- Soul class (4 types, spawn rates)
- Particle class (animation with lifetime)
- gameState object (centralized state)
- gameLoop() — update all entities
- drawGame(ctx) — render on canvas
- spawnWave(), spawnBoss(), collision detection
- **Animation state handling:** currentState, animationTime, frameIndex for sprite selection

**index.html (~600 lines):**
- Canvas 1000×600
- Character select buttons
- HUD updates (real-time)
- Death screen modal
- WASD + E input handling
- Sprite references (to images generated by Dali)
- Animation frame cycling for each entity

### What Dali Will Generate

**Sprite Sheets (for each type):**
- `knight.png` — idle, run, attack, hit, death (48×48 each frame)
- `witch.png` — idle, run, cast, hit, death
- `rogue.png` — idle, run, attack, dodge, death
- `zombie.png`, `spectre.png`, `cultist.png` (regular enemies)
- `vampire.png`, `wraith.png`, `corrupted_knight.png`, `warden.png` (elites)
- `shadow_lord.png`, `void_rift.png`, `ancient_one.png` (bosses)
- `particles.png` — slash, explosion, spark, blood, glow
- `map.png` — background with mountains, pillars, rune
- `ui.png` — health bar, icons, borders

**Total:** ~12-15 sprite sheets, all optimized PNG, indexed colors for web

### What Sonic Will Generate

**Animation Specifications (for each sprite sheet):**
- Frame timings (e.g., idle: 0.25s per frame, 8 frames = 2s loop)
- Loop points (idle loops, attack doesn't)
- Transition rules (idle → run, run → idle, attack → idle)
- Physics (gravity for particles, acceleration)
- Easing curves (ease-in for attacks, ease-out for deaths)
- Sonic will provide JSON files with animation metadata

### How It All Connects

1. **Dali generates sprites** → Saved as PNG files in project
2. **Sonic generates animation specs** → JSON files describe frame timing
3. **game.js loads both** → Creates Sprite objects with frame data
4. **Animation loop** → Uses currentState + animationTime to pick frame index
5. **drawGame()** → Calls ctx.drawImage with correct sprite frame

---

## PART 5: TECHNICAL SPECS

### Canvas API Usage
- `ctx.drawImage(sprite, srcX, srcY, srcW, srcH, destX, destY, destW, destH)`
- `ctx.fillRect()`, `ctx.arc()` for shapes (fallback if sprite missing)
- `ctx.fillText()` for HUD

### Performance Target
- 60 FPS with 50+ enemies
- Sprite sheets cached in memory
- Particle limit: 500 active particles max
- Collision: Distance-based, O(n²) acceptable for enemy count

### File Structure
```
souls-of-abyss/
├── index.html          ← From Cody (HTML + Canvas setup)
├── game.js             ← From Cody (Logic + Animation system)
├── sprites/
│   ├── knight.png      ← From Dali
│   ├── witch.png
│   ├── rogue.png
│   ├── zombie.png
│   ├── ... (9 more enemies)
│   ├── particles.png
│   └── map.png
├── animations/
│   ├── knight.json     ← From Sonic
│   ├── zombie.json
│   └── ... (metadata)
├── README.md
└── GAME-DESIGN.md
```

### Success Criteria
- ✅ All 9 weapons work with correct mechanics
- ✅ All 10 enemy types spawn with difficulty scaling
- ✅ Characters animate smoothly (no jank)
- ✅ Sprites load and display correctly
- ✅ 60 FPS maintained with 50+ entities
- ✅ Bosses spawn every 120s with new sprites
- ✅ Particles spawn on damage, pickup, death
- ✅ HUD updates in real-time
- ✅ Death screen shows stats
- ✅ No console errors

---

## PART 6: AGENTS & WORKFLOW

### Agent Assignments

| Agent | Task | Files |
|-------|------|-------|
| **Cody** (Developer) | game.js + index.html | Code generation |
| **Dali** (Designer) | Sprite sheets | 12 PNG files |
| **Sonic** (Motion) | Animation specs | JSON metadata |
| **Jace** (QA) | Bug fixing & optimization | Code review |

### Generation Workflow

```
1. Cody generates game.js
   - Loads sprite references (fallback: shapes)
   - Sprite object with frame timing
   - drawGame() uses ctx.drawImage()

2. Dali generates sprites
   - Knight, Witch, Rogue (characters)
   - 7 enemy types (regular + elite)
   - 3 bosses
   - Particles, UI, map
   
3. Sonic generates animation JSON
   - Frame counts per animation state
   - Timing for each frame
   - Loop/non-loop flags
   
4. Cody updates game.js to load JSON
   - Links sprite sheets to animation specs
   - Updates animation state machine
   
5. Jace tests everything
   - Runs game in browser
   - Checks sprite alignment
   - Verifies 60 FPS
   - Fixes bugs
```

---

## PART 7: PROMPTS FOR EACH AGENT

### For Cody (game.js + index.html)
See PROMPTS.md → PROMPT #1 & #2 (with animation system added)

### For Dali (Sprite Generation)
See PROMPTS.md → PROMPT #3

### For Sonic (Animation Specs)
See PROMPTS.md → PROMPT #4

---

This design **fully leverages Quadcode IDE agents** while maintaining scope and quality.
